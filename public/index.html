<!DOCTYPE html>
<html>
<head>
<title>APK Signer</title>
<style>
body{background:#141e30;color:#fff;font-family:sans-serif;display:flex;justify-content:center;align-items:center;height:100vh}
.box{background:#1f2a44;padding:20px;border-radius:10px;width:400px;text-align:center}
#log{height:120px;overflow:auto;background:#000;padding:10px;margin-top:10px}
</style>
</head>
<body>
<div class="box">
<h2>APK Signer</h2>
<input type="file" id="apk"><br><br>
<button onclick="sign()">Sign</button>
<div id="log"></div>
</div>

<script>
let log = t => document.getElementById("log").innerHTML += t+"<br>";

async function sign(){
  const f=document.getElementById("apk").files[0];
  if(!f) return log("No file");

  const fd=new FormData();
  fd.append("apk",f);

  const r=await fetch("/upload",{method:"POST",body:fd});
  const j=await r.json();
  log("Job: "+j.jobId);

  const i=setInterval(async()=>{
    const s=await fetch("/status/"+j.jobId).then(r=>r.json());
    log("Status: "+s.status);
    if(s.status==="done"){
      clearInterval(i);
      window.location=s.downloadUrl;
    }
  },1500);
}
</script>
</body>
</html>
